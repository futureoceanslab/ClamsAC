gl <- lapply(plots, function(x) x + theme(legend.position="none"))
gl <- c(gl, ncol = ncol, nrow = nrow)
combined <- switch(position,
"bottom" = arrangeGrob(do.call(arrangeGrob, gl),
legend,
ncol = 1,
heights = unit.c(unit(1, "npc") - lheight, lheight)),
"right" = arrangeGrob(do.call(arrangeGrob, gl),
legend,
ncol = 2,
widths = unit.c(unit(1, "npc") - lwidth, lwidth)))
grid.newpage()
grid.draw(combined)
# return gtable invisibly
invisible(combined)
}
grid_arrange_shared_legend(p3, p1, p2, nrow = 1, ncol =3)
p1<-ggplot(data=na.omit(SAC_factors), aes(x= guild , y=VALUE, fill=(FACTOR)))+
geom_bar(aes(fill = FACTOR),stat = "identity")+
scale_fill_manual(values=c("seagreen4","seagreen4","seagreen4", "seagreen4", "seagreen4"))+
facet_grid(~FACTOR)+
coord_flip()+
theme_classic()+
theme(text = element_text(size=(8)), axis.text.y = element_text(size = 7, hjust = 1))+
ylab("SAC Factors")
p1
p2<-ggplot(data=na.omit(Eco_factors), aes(x= guild , y=VALUE, fill=(FACTOR)))+
geom_bar(aes(fill = FACTOR),stat = "identity")+
scale_fill_manual(values=c("cornsilk3","cornsilk3","cornsilk3"))+
facet_grid(~FACTOR)+
coord_flip()+
theme_classic()+
theme(text = element_text(size=(8)), axis.text.y = element_text(size = 7, hjust = 1))+
ylab("Eco Factors")
p2
p3<-ggplot(data=na.omit(SS_factors), aes(x= guild , y=VALUE, fill=FACTOR))+
geom_bar(aes(fill = FACTOR),stat = "identity")+
scale_fill_manual(values=c("yellow3","yellow3","yellow3"))+
facet_grid(~FACTOR)+
coord_flip()+
theme_minimal()+
theme(text = element_text(size=(8)))+
ylab("SS FACTORS")
p3
Eco_factors <- read_csv2("data/Eco factors.csv")
Eco_factors <- Eco_factors [, c(2:5)]%>% gather(FACTOR, VALUE,-guild, factor_key=TRUE)  %>% mutate(FACTOR=gsub("\\."," ",as.character(FACTOR)))  %>% mutate(FACTOR=factor(FACTOR,levels = c("CATCH_TREND","THREAT","HEALTH")))
SAC_factors <- read_csv2("data/SAC factors.csv")
SAC_factors <- SAC_factors [, c(2:7)]%>% gather(FACTOR, VALUE,-guild, factor_key=TRUE)  %>% mutate(FACTOR=gsub("\\."," ",as.character(FACTOR)))  %>% mutate(FACTOR=factor(FACTOR,levels = c("HM_AGENCY","LVL_DVNT","EC_STRENGHT", "AD_MNGMT", "SC_CAPITAL")))
SS_factors <- read.csv2("data/SS factors.csv")
SS_factors <- SS_factors [, c(2:5)]%>% gather(FACTOR, VALUE,-guild, factor_key=TRUE)  %>% mutate(FACTOR=gsub("\\."," ",as.character(FACTOR)))  %>% mutate(FACTOR=factor(FACTOR,levels = c("SEA_CONDITION","DIV_RESOURCE","DEPENDENCE")))
View(SS_factors)
View(SS_factors)
SS_factors <- read.csv2("data/SS factors.csv")
SS_factors <- SS_factors [, c(2:5)]%>% gather(FACTOR, VALUE,-guild, factor_key=TRUE)  %>% mutate(FACTOR=gsub("\\."," ",as.character(FACTOR)))  %>% mutate(FACTOR=factor(FACTOR,levels = c("SEA_CONDITION","DIV_RESOURCE","DEPENDENCE")))
#####
SS_factors <- read.csv2("data/SS factors.csv")
SS_factors <- read.csv2("data/SS factors.csv")
SS_factors <- read.csv2("data/SS factors.csv")
SS_factors <- read.csv2("data/SS factors.csv")
SS_factors <- SS_factors [, c(2:5)]%>% gather(FACTOR, VALUE,-guild, factor_key=TRUE)  %>% mutate(FACTOR=gsub("\\."," ",as.character(FACTOR)))  %>% mutate(FACTOR=factor(FACTOR,levels = c("SEA_CONDITION","DIV_RESOURCE","DEPENDENCE")))
SS_factors <- read.csv2("data/SS factors.csv")
SAC_factors <- read_csv2("data/SAC factors.csv")
SS_factors <- read.csv2("data/SS factors.csv")
SS_factors <- SS_factors [, c(2:5)]%>% gather(FACTOR, VALUE,-guild, factor_key=TRUE)  %>% mutate(FACTOR=gsub("\\."," ",as.character(FACTOR)))  %>% mutate(FACTOR=factor(FACTOR,levels = c("SEA_CONDITION","DIV_RESOURCE","DEPENDENCE")))
p1<-ggplot(data=na.omit(SAC_factors), aes(x= guild , y=VALUE, fill=(FACTOR)))+
geom_bar(aes(fill = FACTOR),stat = "identity")+
scale_fill_manual(values=c("seagreen4","seagreen4","seagreen4", "seagreen4", "seagreen4"))+
facet_grid(~FACTOR)+
coord_flip()+
theme_classic()+
theme(text = element_text(size=(8)), axis.text.y = element_text(size = 7, hjust = 1))+
ylab("SAC Factors")
p1
p2<-ggplot(data=na.omit(Eco_factors), aes(x= guild , y=VALUE, fill=(FACTOR)))+
geom_bar(aes(fill = FACTOR),stat = "identity")+
scale_fill_manual(values=c("cornsilk3","cornsilk3","cornsilk3"))+
facet_grid(~FACTOR)+
coord_flip()+
theme_classic()+
theme(text = element_text(size=(8)), axis.text.y = element_text(size = 7, hjust = 1))+
ylab("Eco Factors")
p2
p3<-ggplot(data=na.omit(SS_factors), aes(x= guild , y=VALUE, fill=FACTOR))+
geom_bar(aes(fill = FACTOR),stat = "identity")+
scale_fill_manual(values=c("yellow3","yellow3","yellow3"))+
facet_grid(~FACTOR)+
coord_flip()+
theme_minimal()+
theme(text = element_text(size=(8)))+
ylab("SS FACTORS")
p3
grid_arrange_shared_legend(p3, p1, p2, nrow = 1, ncol =3)
p1<-ggplot(data=na.omit(SAC_factors), aes(x= guild , y=VALUE, fill=(FACTOR)))+
geom_bar(aes(fill = FACTOR),stat = "identity")+
scale_fill_manual(values=c("seagreen4","seagreen4","seagreen4", "seagreen4", "seagreen4"))+
facet_grid(~FACTOR)+
coord_flip()+
theme_classic()+
theme(text = element_text(size=(8)), axis.text.y = element_text(size = 7, hjust = 1))+
ylab("SAC Factors")
p1
Eco_factors <- read_csv2("data/Eco factors.csv")
Eco_factors <- Eco_factors [, c(2:5)]%>% gather(FACTOR, VALUE,-guild, factor_key=TRUE)  %>% mutate(FACTOR=gsub("\\."," ",as.character(FACTOR)))  %>% mutate(FACTOR=factor(FACTOR,levels = c("CATCH_TREND","THREAT","HEALTH")))
SAC_factors <- read_csv2("data/SAC factors.csv")
SAC_factors <- SAC_factors [, c(2:7)]%>% gather(FACTOR, VALUE,-guild, factor_key=TRUE)  %>% mutate(FACTOR=gsub("\\."," ",as.character(FACTOR)))  %>% mutate(FACTOR=factor(FACTOR,levels = c("HM_AGENCY","LVL_DVNT","EC_STRENGHT", "AD_MNGMT", "SC_CAPITAL")))
SS_factors <- read.csv2("data/SS factors.csv")
SS_factors <- SS_factors [, c(2:5)]%>% gather(FACTOR, VALUE,-guild, factor_key=TRUE)  %>% mutate(FACTOR=gsub("\\."," ",as.character(FACTOR)))  %>% mutate(FACTOR=factor(FACTOR,levels = c("SEA_CONDITION","DIV_RESOURCE","DEPENDENCE")))
p1<-ggplot(data=na.omit(SAC_factors), aes(x= guild , y=VALUE, fill=(FACTOR)))+
geom_bar(aes(fill = FACTOR),stat = "identity")+
scale_fill_manual(values=c("seagreen4","seagreen4","seagreen4", "seagreen4", "seagreen4"))+
facet_grid(~FACTOR)+
coord_flip()+
theme_classic()+
theme(text = element_text(size=(8)), axis.text.y = element_text(size = 7, hjust = 1))+
ylab("SAC Factors")
p1
p2<-ggplot(data=na.omit(Eco_factors), aes(x= guild , y=VALUE, fill=(FACTOR)))+
geom_bar(aes(fill = FACTOR),stat = "identity")+
scale_fill_manual(values=c("cornsilk3","cornsilk3","cornsilk3"))+
facet_grid(~FACTOR)+
coord_flip()+
theme_classic()+
theme(text = element_text(size=(8)), axis.text.y = element_text(size = 7, hjust = 1))+
ylab("Eco Factors")
p2
p3<-ggplot(data=na.omit(SS_factors), aes(x= guild , y=VALUE, fill=FACTOR))+
geom_bar(aes(fill = FACTOR),stat = "identity")+
scale_fill_manual(values=c("yellow3","yellow3","yellow3"))+
facet_grid(~FACTOR)+
coord_flip()+
theme_classic()+
theme(text = element_text(size=(8)))+
ylab("SS FACTORS")
p3
grid_arrange_shared_legend(p3, p1, p2, nrow = 1, ncol =3)
dimensions <- c("Eco_factors","SAC_factors","SS_factors")
dimension_colors <- list(eco_factors=c("seagreen3","seagreen4"),
soc_factors=c("yellow3","yellow4"),
ins_factors=c("cornsilk3","cornsilk4"))
graphs <- dimensions  %>% lapply(function(dimension){
# dimension <- "soc_factors"
x<- get(dimension)
g <- ggplot(data=na.omit(x), aes(x= COUNTRIES , y=VALUE, fill=SPECIES, group=SPECIES))+
geom_bar(stat = "identity", position=position_dodge(width=0.4), width=0.3)+
scale_fill_manual(values=dimension_colors[[dimension]],name="SPECIES")+
facet_grid(~FACTOR)+
coord_flip()+
theme_classic()+
ylab("")+
xlab("COUNTRY")+
theme(axis.text.y = element_text(size=20, color="black"),
axis.text.x = element_text(size=16,color="black",angle=50,hjust=1),
legend.text = element_text(size=22,color = "black"),
legend.title = element_text(size=24,color="black"),
panel.spacing.x = unit(1,"lines"),
strip.text = element_text(color="black",face="bold",size=11))
if(dimension!="eco_factors"){
g <- g + theme(axis.title.y = element_blank())
}else{
g <- g + theme(axis.title.y = element_text(size=26, color="black"))
}
g
})
png("Figures/Fig 2 SI.png",width=25,height=12,units="in",res=300)
do.call(grid_arrange_shared_legend,c(graphs, list(nrow = 1, ncol = 3)))
dev.off()
dimensions <- c("Eco_factors","SAC_factors","SS_factors")
dimension_colors <- list(eco_factors=c("seagreen3","seagreen4"),
soc_factors=c("yellow3","yellow4"),
ins_factors=c("cornsilk3","cornsilk4"))
graphs <- dimensions  %>% lapply(function(dimension){
# dimension <- "soc_factors"
x<- get(dimension)
g <- ggplot(data=na.omit(x), aes(x= guild , y=VALUE, fill=SPECIES, group=SPECIES))+
geom_bar(stat = "identity", position=position_dodge(width=0.4), width=0.3)+
scale_fill_manual(values=dimension_colors[[dimension]],name="SPECIES")+
facet_grid(~FACTOR)+
coord_flip()+
theme_classic()+
ylab("")+
xlab("COUNTRY")+
theme(axis.text.y = element_text(size=20, color="black"),
axis.text.x = element_text(size=16,color="black",angle=50,hjust=1),
legend.text = element_text(size=22,color = "black"),
legend.title = element_text(size=24,color="black"),
panel.spacing.x = unit(1,"lines"),
strip.text = element_text(color="black",face="bold",size=11))
if(dimension!="eco_factors"){
g <- g + theme(axis.title.y = element_blank())
}else{
g <- g + theme(axis.title.y = element_text(size=26, color="black"))
}
g
})
png("Figures/Fig 2 SI.png",width=25,height=12,units="in",res=300)
do.call(grid_arrange_shared_legend,c(graphs, list(nrow = 1, ncol = 3)))
dev.off()
dimensions <- c("Eco_factors","SAC_factors","SS_factors")
dimension_colors <- list(eco_factors=c("seagreen3","seagreen4"),
soc_factors=c("yellow3","yellow4"),
ins_factors=c("cornsilk3","cornsilk4"))
graphs <- dimensions  %>% lapply(function(dimension){
# dimension <- "soc_factors"
x<- get(dimension)
g <- ggplot(data=na.omit(x), aes(x= guild , y=VALUE, fill=FACTOR))+
geom_bar(stat = "identity", position=position_dodge(width=0.4), width=0.3)+
scale_fill_manual(values=dimension_colors[[dimension]],name="SPECIES")+
facet_grid(~FACTOR)+
coord_flip()+
theme_classic()+
ylab("")+
xlab("COUNTRY")+
theme(axis.text.y = element_text(size=20, color="black"),
axis.text.x = element_text(size=16,color="black",angle=50,hjust=1),
legend.text = element_text(size=22,color = "black"),
legend.title = element_text(size=24,color="black"),
panel.spacing.x = unit(1,"lines"),
strip.text = element_text(color="black",face="bold",size=11))
if(dimension!="eco_factors"){
g <- g + theme(axis.title.y = element_blank())
}else{
g <- g + theme(axis.title.y = element_text(size=26, color="black"))
}
g
})
png("Figures/Fig 2 SI.png",width=25,height=12,units="in",res=300)
do.call(grid_arrange_shared_legend,c(graphs, list(nrow = 1, ncol = 3)))
dev.off()
dimensions <- c("Eco_factors","SAC_factors","SS_factors")
dimension_colors <- list(eco_factors=c("seagreen3"),
soc_factors=c("yellow3"),
ins_factors=c("cornsilk3"))
graphs <- dimensions  %>% lapply(function(dimension){
# dimension <- "soc_factors"
x<- get(dimension)
g <- ggplot(data=na.omit(x), aes(x= guild , y=VALUE, fill=FACTOR))+
geom_bar(stat = "identity", position=position_dodge(width=0.4), width=0.3)+
scale_fill_manual(values=dimension_colors[[dimension]],name="SPECIES")+
facet_grid(~FACTOR)+
coord_flip()+
theme_classic()+
ylab("")+
xlab("COUNTRY")+
theme(axis.text.y = element_text(size=20, color="black"),
axis.text.x = element_text(size=16,color="black",angle=50,hjust=1),
legend.text = element_text(size=22,color = "black"),
legend.title = element_text(size=24,color="black"),
panel.spacing.x = unit(1,"lines"),
strip.text = element_text(color="black",face="bold",size=11))
if(dimension!="eco_factors"){
g <- g + theme(axis.title.y = element_blank())
}else{
g <- g + theme(axis.title.y = element_text(size=26, color="black"))
}
g
})
png("Figures/Fig 2 SI.png",width=25,height=12,units="in",res=300)
do.call(grid_arrange_shared_legend,c(graphs, list(nrow = 1, ncol = 3)))
dev.off()
dimensions <- c("Eco_factors","SAC_factors","SS_factors")
dimension_colors <- list(eco_factors=c("seagreen3"),
soc_factors=c("yellow3"),
ins_factors=c("cornsilk3"))
graphs <- dimensions  %>% lapply(function(dimension){
# dimension <- "soc_factors"
x<- get(dimension)
g <- ggplot(data=na.omit(x), aes(x= guild , y=VALUE, fill=FACTOR))+
geom_bar(stat = "identity", position=position_dodge(width=0.4), width=0.3)+
scale_fill_manual(values=dimension_colors[[dimension]],name="FACTOR")+
facet_grid(~FACTOR)+
coord_flip()+
theme_classic()+
ylab("")+
xlab("COUNTRY")+
theme(axis.text.y = element_text(size=20, color="black"),
axis.text.x = element_text(size=16,color="black",angle=50,hjust=1),
legend.text = element_text(size=22,color = "black"),
legend.title = element_text(size=24,color="black"),
panel.spacing.x = unit(1,"lines"),
strip.text = element_text(color="black",face="bold",size=11))
if(dimension!="eco_factors"){
g <- g + theme(axis.title.y = element_blank())
}else{
g <- g + theme(axis.title.y = element_text(size=26, color="black"))
}
g
})
png("Figures/Fig 2 SI.png",width=25,height=12,units="in",res=300)
do.call(grid_arrange_shared_legend,c(graphs, list(nrow = 1, ncol = 3)))
dev.off()
dimensions <- c("Eco_factors","SAC_factors","SS_factors")
dimension_colors <- list(eco_factors=c("seagreen3"),
soc_factors=c("yellow3"),
ins_factors=c("cornsilk3"))
graphs <- dimensions  %>% lapply(function(dimension){
# dimension <- "soc_factors"
x<- get(dimension)
g <- ggplot(data=na.omit(x), aes(x= guild , y=VALUE, fill=FACTOR))+
geom_bar(stat = "identity", position=position_dodge(width=0.4), width=0.3)+
scale_fill_manual(values=c("cornsilk3","cornsilk3","cornsilk3", "cornsilk3"))+
facet_grid(~FACTOR)+
coord_flip()+
theme_classic()+
ylab("")+
xlab("COUNTRY")+
theme(axis.text.y = element_text(size=20, color="black"),
axis.text.x = element_text(size=16,color="black",angle=50,hjust=1),
legend.text = element_text(size=22,color = "black"),
legend.title = element_text(size=24,color="black"),
panel.spacing.x = unit(1,"lines"),
strip.text = element_text(color="black",face="bold",size=11))
if(dimension!="eco_factors"){
g <- g + theme(axis.title.y = element_blank())
}else{
g <- g + theme(axis.title.y = element_text(size=26, color="black"))
}
g
})
png("Figures/Fig 2 SI.png",width=25,height=12,units="in",res=300)
do.call(grid_arrange_shared_legend,c(graphs, list(nrow = 1, ncol = 3)))
dev.off()
graphs <- dimensions  %>% lapply(function(dimension){
# dimension <- "soc_factors"
x<- get(dimension)
g <- ggplot(data=na.omit(x), aes(x= guild , y=VALUE, fill=FACTOR))+
geom_bar(stat = "identity", position=position_dodge(width=0.4), width=0.3)+
scale_fill_manual(values=c("cornsilk3","cornsilk3","cornsilk3", "cornsilk3", "cornsilk3"))+
facet_grid(~FACTOR)+
coord_flip()+
theme_classic()+
ylab("")+
xlab("COUNTRY")+
theme(axis.text.y = element_text(size=20, color="black"),
axis.text.x = element_text(size=16,color="black",angle=50,hjust=1),
legend.text = element_text(size=22,color = "black"),
legend.title = element_text(size=24,color="black"),
panel.spacing.x = unit(1,"lines"),
strip.text = element_text(color="black",face="bold",size=11))
if(dimension!="eco_factors"){
g <- g + theme(axis.title.y = element_blank())
}else{
g <- g + theme(axis.title.y = element_text(size=26, color="black"))
}
g
})
png("Figures/Fig 2 SI.png",width=25,height=12,units="in",res=300)
do.call(grid_arrange_shared_legend,c(graphs, list(nrow = 1, ncol = 3)))
dev.off()
graphs <- dimensions  %>% lapply(function(dimension){
# dimension <- "soc_factors"
x<- get(dimension)
g <- ggplot(data=na.omit(x), aes(x= guild , y=VALUE, fill=FACTOR))+
geom_bar(stat = "identity", position=position_dodge(width=0.4), width=0.3)+
scale_fill_manual(values=c("cornsilk3","cornsilk3","cornsilk3", "cornsilk3", "cornsilk3"))+
facet_grid(~FACTOR)+
coord_flip()+
theme_minimal()+
ylab("")+
xlab("COUNTRY")+
theme(axis.text.y = element_text(size=20, color="black"),
axis.text.x = element_text(size=16,color="black",angle=50,hjust=1),
legend.text = element_text(size=22,color = "black"),
legend.title = element_text(size=24,color="black"),
panel.spacing.x = unit(1,"lines"),
strip.text = element_text(color="black",face="bold",size=11))
if(dimension!="eco_factors"){
g <- g + theme(axis.title.y = element_blank())
}else{
g <- g + theme(axis.title.y = element_text(size=26, color="black"))
}
g
})
png("Figures/Fig 2 SI.png",width=25,height=12,units="in",res=300)
do.call(grid_arrange_shared_legend,c(graphs, list(nrow = 1, ncol = 3)))
dev.off()
dimensions <- c("Eco_factors","SAC_factors","SS_factors")
dimension_colors <- list(eco_factors=c("seagreen3"),
soc_factors=c("yellow3"),
ins_factors=c("cornsilk3"))
graphs <- dimensions  %>% lapply(function(dimension){
# dimension <- "soc_factors"
x<- get(dimension)
g <- ggplot(data=na.omit(x), aes(x= guild , y=VALUE, fill=FACTOR))+
geom_bar(stat = "identity", position=position_dodge(width=0.4), width=0.3)+
scale_fill_manual(values=c("cornsilk3","cornsilk3","cornsilk3", "cornsilk3", "cornsilk3"))+
facet_grid(~FACTOR)+
coord_flip()+
theme_minimal()+
ylab("")+
xlab("COUNTRY")+
theme(axis.text.y = element_text(size=20, color="black"),
axis.text.x = element_text(size=16,color="black",angle=50,hjust=1),
legend.text = element_text(size=22,color = "black"),
legend.title = element_text(size=24,color="black"),
panel.spacing.x = unit(1,"lines"),
strip.text = element_text(color="black",face="bold",size=11))
if(dimension!="eco_factors"){
g <- g + theme(axis.title.y = element_blank())
}else{
g <- g + theme(axis.title.y = element_text(size=26, color="black"))
}
g
})
png("Figures/Fig 3.png",width=25,height=12,units="in",res=300)
do.call(grid_arrange_shared_legend,c(graphs, list(nrow = 1, ncol = 3)))
dev.off()
p1<-ggplot(data=na.omit(SAC_factors), aes(x= guild , y=VALUE, fill=(FACTOR)))+
geom_bar(aes(fill = FACTOR),stat = "identity")+
scale_fill_manual(values=c("seagreen4","seagreen4","seagreen4", "seagreen4", "seagreen4"))+
facet_grid(~FACTOR)+
coord_flip()+
theme_classic()+
theme(text = element_text(size=(8)), axis.text.y = element_text(size = 7, hjust = 1))+
ylab("SAC Factors")
p1
p2<-ggplot(data=na.omit(Eco_factors), aes(x= guild , y=VALUE, fill=(FACTOR)))+
geom_bar(aes(fill = FACTOR),stat = "identity")+
scale_fill_manual(values=c("cornsilk3","cornsilk3","cornsilk3"))+
facet_grid(~FACTOR)+
coord_flip()+
theme_classic()+
theme(text = element_text(size=(8)), axis.text.y = element_text(size = 7, hjust = 1))+
ylab("Eco Factors")
p2
p3<-ggplot(data=na.omit(SS_factors), aes(x= guild , y=VALUE, fill=FACTOR))+
geom_bar(aes(fill = FACTOR),stat = "identity")+
scale_fill_manual(values=c("yellow3","yellow3","yellow3"))+
facet_grid(~FACTOR)+
coord_flip()+
theme_classic()+
theme(text = element_text(size=(8)))+
ylab("SS FACTORS")
p3
grid_arrange_shared_legend(p3, p1, p2, nrow = 1, ncol =3)
ggsave("Figures/Fig 3_1.png",width = 10,height = 8,units = "in")
ggsave("Figures/Fig 3_1.png",width = 10,height = 8,units = "in")
grid_arrange_shared_legend(p3, p1, p2, nrow = 1, ncol =3)
ggsave("Figures/Fig 3_1.png",width = 10,height = 8,units = "in")
png("Figures/Fig 3_1.png",width=25,height=12,units="in",res=300)
do.call(grid_arrange_shared_legend,c(graphs, list(nrow = 1, ncol = 3)))
grid_arrange_shared_legend(p3, p1, p2, nrow = 1, ncol =3)
png("Figures/Fig 3_1.png",width=25,height=12,units="in",res=300)
do.call(grid_arrange_shared_legend,c(graphs, list(nrow = 1, ncol = 3)))
grid_arrange_shared_legend(p3, p1, p2, nrow = 1, ncol =3)
png("Figures/Fig 3_1.png",width=25,height=12,units="in",res=300)
do.call(grid_arrange_shared_legend,c(graphs, list(nrow = 1, ncol = 3)))
dev.off()
png("Figures/Fig 5 SI.png",width=9,height=9,units="in",res=300)
grid.arrange(ggplotGrob(p1), ggplotGrob(p2),ggplotGrob(p3), layout_matrix = cbind(c(1,3)))
dev.off()
p1<-ggplot(data=na.omit(SAC_factors), aes(x= guild , y=VALUE, fill=(FACTOR)))+
geom_bar(aes(fill = FACTOR),stat = "identity")+
scale_fill_manual(values=c("seagreen4","seagreen4","seagreen4", "seagreen4", "seagreen4"))+
facet_grid(~FACTOR)+
coord_flip()+
theme_classic()+
theme(text = element_text(size=(8)), axis.text.y = element_text(size = 7, hjust = 1))+
ylab("SAC Factors")
p1
p2<-ggplot(data=na.omit(Eco_factors), aes(x= guild , y=VALUE, fill=(FACTOR)))+
geom_bar(aes(fill = FACTOR),stat = "identity")+
scale_fill_manual(values=c("cornsilk3","cornsilk3","cornsilk3"))+
facet_grid(~FACTOR)+
coord_flip()+
theme_classic()+
theme(text = element_text(size=(8)), axis.text.y = element_text(size = 7, hjust = 1))+
ylab("Eco Factors")
p2
p3<-ggplot(data=na.omit(SS_factors), aes(x= guild , y=VALUE, fill=FACTOR))+
geom_bar(aes(fill = FACTOR),stat = "identity")+
scale_fill_manual(values=c("yellow3","yellow3","yellow3"))+
facet_grid(~FACTOR)+
coord_flip()+
theme_classic()+
theme(text = element_text(size=(8)))+
ylab("SS FACTORS")
p3
png("Figures/Fig 5 SI.png",width=9,height=9,units="in",res=300)
grid.arrange(ggplotGrob(p1), ggplotGrob(p2),ggplotGrob(p3), layout_matrix = cbind(c(1,3)))
dev.off()
png("Figures/Fig 5 SI.png",width=9,height=9,units="in",res=300)
grid.arrange(ggplotGrob(p1), ggplotGrob(p2), layout_matrix = cbind(c(1,2)))
dev.off()
png("Figures/Fig 5 SI.png",width=9,height=9,units="in",res=300)
grid.arrange(ggplotGrob(p1), ggplotGrob(p2),ggplotGrob(p3), layout_matrix = cbind(c(2,2)))
dev.off()
a<- grid_arrange_shared_legend(p3, p1, p2, nrow = 1, ncol =3)
ggsave("Figures/Fig 2.png",width = 10,height = 8,units = "in")
grid_arrange_shared_legend(p3, p1, p2, nrow = 1, ncol =3)
###save manual##
AC_index <- read_csv2("data/AC index.csv")
AC_index <- AC_index [, c(2:3)]
##### 2. PLOT #####
ggplot(AC_index, aes(x=guild, y=AC))+
geom_bar(stat="identity")+
coord_flip()+
theme_classic()+
theme(legend.position = "none",
strip.text = element_text(size=18,color="black",face="bold",hjust=0),
strip.background = element_blank(),
axis.text = element_text(size=16, color="black"),
axis.title = element_text(size=20, color="black"),
legend.text = element_text(size=22,color = "black"),
legend.title = element_text(size=24,color="black"))
# Save
ggsave("Figures/Fig 2.png",width = 10,height = 8,units = "in")
grid_arrange_shared_legend(p3, p1, p2, nrow = 1, ncol =3)
###save manual##
grid_arrange_shared_legend(p3, p1, p2, nrow = 1, ncol =3)
png("Figures/Fig 3_1.png",width=25,height=12,units="in",res=300)
do.call(grid_arrange_shared_legend,c(graphs, list(nrow = 1, ncol = 3)))
dev.off()
